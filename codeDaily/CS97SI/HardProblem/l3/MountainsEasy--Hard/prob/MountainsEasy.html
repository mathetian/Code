<html>
<head>
    <title>MountainsEasy</title>
</head>
<body>
<h1><a href="http://community.topcoder.com/tc?module=ProblemDetail&amp;rd=15487&amp;pm=12380">MountainsEasy</a></h1>

<p><em>Single Round Match 567 Round 1 - Division II, Level Three</em></p>

<h2>Statement</h2>

<p>Manao is developing a simple 2-D computer game. The screen of the game is H pixels high and W pixels wide (1 &lt;= H, W &lt;= 50).</p>

<p>Manao is currently working on the background which should be filled with several mountains. The contents of the screen are stored in an array of characters pix where pix[x, y] gives the contents of the pixel at column x, row y. Both indices are 0-based. Columns are numbered left to right and rows are numbered bottom to top. Character 'X' denotes a part of a mountain and character '.' means that this pixel is not covered by any mountains.</p>

<p>Manao wants to draw <em>N</em> mountains in order to achieve the necessary background. The i-th (0-based index) mountain is described by its peak position (X[i], Y[i]), 0 &lt;= X[i] &lt; W, 0 &lt;= Y[i] &lt; H. In order to draw the mountains, the following pseudocode is used:</p>

<p>Fill all elements of pix with '.' characters.</p>

<p>For 0&lt;=i&lt;N:</p>

<p>For 0&lt;=x&lt;W:</p>

<p>For 0&lt;=y&lt;=Y[i] - |x - X[i]|:</p>

<p>pix[x, y] := 'X'</p>

<p>For example, consider three mountains with peaks at (1, 1), (2, 2) and (4, 1). Once these mountains are drawn on a screen with H = 3, W = 6, the resulting picture will look as follows:
..X...
.XXXX.
XXXXXX</p>

<p>You are given a String[] <em>picture</em> describing the background which Manao wants to obtain. It contains H elements and each element contains W characters. The required value of pix[x, y] is given by x-th character of <em>picture</em>[H-y-1]. In other words, elements of <em>picture</em> list the rows of the screen from top to bottom.</p>

<p>You are also given an int <em>N</em>. Count the number of sequences S of exactly <em>N</em> mountains such that when you draw all mountains from S on the screen as described above, the result will match the given <em>picture</em>. Return this number modulo 1,000,000,009.</p>

<p>Note that the order of mountains in a sequence is important. Sequences containing the same mountains, but in a different order, are distinct. It is guaranteed that there exists at least one way to obtain the given <em>picture</em> by drawing exactly <em>N</em> mountains.</p>

<h2>Definitions</h2>

<ul>
<li><em>Class</em>: <code>MountainsEasy</code></li>
<li><em>Method</em>: <code>countPlacements</code></li>
<li><em>Parameters</em>: <code>String[], int</code></li>
<li><em>Returns</em>: <code>int</code></li>
<li><em>Method signature</em>: <code>int countPlacements(String[] picture, int N)</code></li>
</ul>


<h2>Constraints</h2>

<ul>
<li><em>picture</em> will contain between 1 and 50 elements, inclusive.</li>
<li>Each element of <em>picture</em> will be between 1 and 50 characters long, inclusive.</li>
<li>All elements of <em>picture</em> will be of the same length.</li>
<li>Each element of <em>picture</em> will consist of 'X' and '.' characters only.</li>
<li><em>N</em> will be between 1 and 50, inclusive.</li>
<li><em>picture</em> can be obtained by drawing exactly <em>N</em> mountains according to the rules given in the problem statement.</li>
</ul>


<h2>Examples</h2>

<h3>Example 1</h3>

<h4>Input</h4>

<p><c>["X.",<br /> "XX"],<br />1</c></p>

<h4>Output</h4>

<p><c>1</c></p>

<h4>Reason</h4>

<p>This is a mountain (0, 1).</p>

<h3>Example 2</h3>

<h4>Input</h4>

<p><c>["X.",<br /> "XX"],<br />2</c></p>

<h4>Output</h4>

<p><c>5</c></p>

<h4>Reason</h4>

<p>Here one of the mountains is completely covered by the other. The five possible sequences are:
(0, 1), (0, 1)
(0, 1), (0, 0)
(0, 1), (1, 0)
(0, 0), (0, 1)
(1, 0), (0, 1)</p>

<h3>Example 3</h3>

<h4>Input</h4>

<p><c>["X.X",<br /> "XXX"],<br />2</c></p>

<h4>Output</h4>

<p><c>2</c></p>

<h4>Reason</h4>

<p>The two possible sequences are:
(0, 1), (2, 1)
(2, 1), (0, 1)</p>

<h3>Example 4</h3>

<h4>Input</h4>

<p><c>["X.X",<br /> "XXX"],<br />3</c></p>

<h4>Output</h4>

<p><c>24</c></p>

<h3>Example 5</h3>

<h4>Input</h4>

<p><c>["......",<br /> "X..X..",<br /> "XXXXXX",<br /> "XXXXXX"],<br />3</c></p>

<h4>Output</h4>

<p><c>6</c></p>

<h4>Reason</h4>

<p>There are three mountains (0, 2), (3, 2), (5, 1) placed in any order.</p>

<h3>Example 6</h3>

<h4>Input</h4>

<p><c>["......",<br /> "X..X..",<br /> "XXXXXX",<br /> "XXXXXX"],<br />4</c></p>

<h4>Output</h4>

<p><c>300</c></p>

<h3>Example 7</h3>

<h4>Input</h4>

<p><c>["....X...X..",<br /> "...XXX.XXX.",<br /> "XXXXXXXXXXX"],<br />10</c></p>

<h4>Output</h4>

<p><c>764632413</c></p>

</body>
</html>